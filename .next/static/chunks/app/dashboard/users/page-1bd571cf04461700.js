(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[618],{58034:function(e,s,a){Promise.resolve().then(a.bind(a,49823))},49823:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return E}});var t=a(57437),n=a(2265),l=a(592),r=a(17343),i=a(10346),d=a(35974),c=a(66070),o=a(62869),u=a(65613),m=a(26110),x=a(95186),h=a(26815),f=a(53647),j=a(50721),g=a(94508);function p(e){let{className:s,...a}=e;return(0,t.jsx)(j.fC,{"data-slot":"switch",className:(0,g.cn)("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",s),...a,children:(0,t.jsx)(j.bU,{"data-slot":"switch-thumb",className:(0,g.cn)("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}var N=a(51817),v=a(51884),b=a(15868),y=a(18930),k=a(82431),w=a(37806),U=a(95805),C=a(35153);function E(){var e,s,a,j,g,E,S,Z,z;let{toast:_}=(0,C.pm)(),[A,D]=(0,n.useState)(1),[R,I]=(0,n.useState)(""),{data:L,isLoading:T,error:P,refetch:M}=(0,l.Mk)({page:A,search:R}),[O,{isLoading:V}]=(0,l.I1)(),[q,{isLoading:F}]=(0,l.UL)(),[B,{isLoading:Q}]=(0,l.ku)(),[Y,{isLoading:K}]=(0,l.kD)(),$=(null==L?void 0:L.content)||(null==L?void 0:L.users)||[],X=(null==L?void 0:L.totalElements)||(null==L?void 0:L.total)||0,H=(null==L?void 0:L.totalPages)||Math.ceil(X/10),[G,J]=(0,n.useState)({open:!1,user:null}),[W,ee]=(0,n.useState)({open:!1,user:null}),[es,ea]=(0,n.useState)({open:!1,user:null}),[et,en]=(0,n.useState)({firstName:"",lastName:"",email:"",enabled:!0}),[el,er]=(0,n.useState)({action:"add",roleName:""}),ei=(0,n.useMemo)(()=>$.filter(e=>e.enabled).length,[$]),ed=(0,n.useMemo)(()=>$.filter(e=>e.roles.includes("ADMIN")).length,[$]),ec=(0,n.useMemo)(()=>$.filter(e=>e.emailVerified).length,[$]),eo=e=>{en({firstName:e.firstName,lastName:e.lastName,email:e.email,enabled:e.enabled}),ee({open:!0,user:e})},eu=e=>{J({open:!0,user:e})},em=e=>{ea({open:!0,user:e}),er({action:"add",roleName:""})},ex=async()=>{if(G.user)try{await O(G.user.keycloakUserId).unwrap(),_({title:"Success",description:"User deleted successfully"}),J({open:!1,user:null})}catch(e){_({title:"Error",description:"Failed to delete user",variant:"destructive"})}},eh=async()=>{if(W.user)try{await Y({keycloakUserId:W.user.keycloakUserId,userData:et}).unwrap(),_({title:"Success",description:"User updated successfully"}),ee({open:!1,user:null})}catch(e){_({title:"Error",description:"Failed to update user",variant:"destructive"})}},ef=async()=>{if(es.user&&el.roleName)try{"add"===el.action?await q({keycloakUserId:es.user.keycloakUserId,roleName:el.roleName}).unwrap():await B({keycloakUserId:es.user.keycloakUserId,roleName:el.roleName}).unwrap(),_({title:"Success",description:"Role ".concat("add"===el.action?"added":"removed"," successfully")}),ea({open:!1,user:null})}catch(e){_({title:"Error",description:"Failed to ".concat(el.action," role"),variant:"destructive"})}},ej=[{key:"displayName",label:"Name",render:(e,s)=>(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:e||"".concat(s.firstName," ").concat(s.lastName)}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:["@",s.username]})]})},{key:"email",label:"Email",render:(e,s)=>(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{children:e}),s.emailVerified&&(0,t.jsx)(d.C,{variant:"outline",className:"text-xs",children:"Verified"})]})},{key:"roles",label:"Roles",render:e=>(0,t.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.slice(0,2).map((e,s)=>(0,t.jsx)(d.C,{variant:"secondary",className:"text-xs",children:"ADMIN"===e?"Admin":e.replace("default-roles-","").replace("_"," ")},s)),e.length>2&&(0,t.jsxs)(d.C,{variant:"outline",className:"text-xs",children:["+",e.length-2]})]})},{key:"enabled",label:"Status",render:e=>(0,t.jsx)(d.C,{variant:e?"default":"destructive",children:e?"Active":"Disabled"})},{key:"createdTimestamp",label:"Created",render:e=>(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:new Date(e).toLocaleDateString()})},{key:"lastLogin",label:"Last Login",render:e=>(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:e?new Date(e).toLocaleDateString():"Never"})},{key:"actions",label:"Actions",render:(e,s)=>(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(o.z,{variant:"outline",size:"sm",onClick:()=>em(s),disabled:F||Q,children:F||Q?(0,t.jsx)(N.Z,{className:"h-3 w-3 animate-spin"}):(0,t.jsx)(v.Z,{className:"h-3 w-3"})}),(0,t.jsx)(o.z,{variant:"outline",size:"sm",onClick:()=>eo(s),disabled:K,children:K?(0,t.jsx)(N.Z,{className:"h-3 w-3 animate-spin"}):(0,t.jsx)(b.Z,{className:"h-3 w-3"})}),(0,t.jsx)(o.z,{variant:"outline",size:"sm",onClick:()=>eu(s),disabled:V,children:V?(0,t.jsx)(N.Z,{className:"h-3 w-3 animate-spin"}):(0,t.jsx)(y.Z,{className:"h-3 w-3"})})]})}];return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:"User Management"}),(0,t.jsx)("p",{className:"text-muted-foreground mt-2",children:"Manage and monitor all users in your system"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsxs)(o.z,{variant:"outline",onClick:()=>{M()},disabled:T,children:[(0,t.jsx)(k.Z,{className:"h-4 w-4 mr-2 ".concat(T?"animate-spin":"")}),"Refresh"]}),(0,t.jsxs)(o.z,{children:[(0,t.jsx)(w.Z,{className:"h-4 w-4 mr-2"}),"Add User"]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,t.jsxs)(c.Zb,{children:[(0,t.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(c.ll,{className:"text-sm font-medium",children:"Total Users"}),(0,t.jsx)(U.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(c.aY,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:X}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"All registered users"})]})]}),(0,t.jsxs)(c.Zb,{children:[(0,t.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(c.ll,{className:"text-sm font-medium",children:"Active Users"}),(0,t.jsx)(U.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(c.aY,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:ei}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Enabled accounts"})]})]}),(0,t.jsxs)(c.Zb,{children:[(0,t.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(c.ll,{className:"text-sm font-medium",children:"Admin Users"}),(0,t.jsx)(U.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(c.aY,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:ed}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Administrator accounts"})]})]}),(0,t.jsxs)(c.Zb,{children:[(0,t.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(c.ll,{className:"text-sm font-medium",children:"Verified Emails"}),(0,t.jsx)(U.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(c.aY,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:ec}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Email verified users"})]})]})]}),P&&(0,t.jsx)(u.bZ,{variant:"destructive",children:(0,t.jsx)(u.X,{children:"object"==typeof P&&"data"in P?String(P.data):String(P)})}),(0,t.jsxs)(c.Zb,{children:[(0,t.jsx)(c.Ol,{children:(0,t.jsx)(c.ll,{children:"All Users"})}),(0,t.jsxs)(c.aY,{children:[(0,t.jsx)(r.w,{data:$,columns:ej,searchPlaceholder:"Search users...",onSearch:e=>{I(e),D(1)},onView:e=>{_({title:"User Details",description:"Viewing details for ".concat(e.displayName||"".concat(e.firstName," ").concat(e.lastName))})},onEdit:eo,onDelete:eu,isLoading:T}),H>1&&(0,t.jsx)("div",{className:"mt-6",children:(0,t.jsx)(i.t,{currentPage:A,totalPages:H,onPageChange:e=>{D(e)}})})]})]}),(0,t.jsx)(m.Vq,{open:G.open,onOpenChange:e=>J({open:e,user:null}),children:(0,t.jsxs)(m.cZ,{children:[(0,t.jsxs)(m.fK,{children:[(0,t.jsx)(m.$N,{children:"Delete User"}),(0,t.jsxs)(m.Be,{children:["Are you sure you want to delete"," ",(null===(e=G.user)||void 0===e?void 0:e.displayName)||"".concat(null===(s=G.user)||void 0===s?void 0:s.firstName," ").concat(null===(a=G.user)||void 0===a?void 0:a.lastName),"? This action cannot be undone."]})]}),(0,t.jsxs)(m.cN,{children:[(0,t.jsx)(o.z,{variant:"outline",onClick:()=>J({open:!1,user:null}),children:"Cancel"}),(0,t.jsxs)(o.z,{variant:"destructive",onClick:ex,disabled:V,children:[V?(0,t.jsx)(N.Z,{className:"h-4 w-4 animate-spin mr-2"}):null,"Delete"]})]})]})}),(0,t.jsx)(m.Vq,{open:W.open,onOpenChange:e=>ee({open:e,user:null}),children:(0,t.jsxs)(m.cZ,{children:[(0,t.jsxs)(m.fK,{children:[(0,t.jsx)(m.$N,{children:"Edit User"}),(0,t.jsxs)(m.Be,{children:["Update user information for"," ",(null===(j=W.user)||void 0===j?void 0:j.displayName)||"".concat(null===(g=W.user)||void 0===g?void 0:g.firstName," ").concat(null===(E=W.user)||void 0===E?void 0:E.lastName)]})]}),(0,t.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(h._,{htmlFor:"firstName",className:"text-right",children:"First Name"}),(0,t.jsx)(x.I,{id:"firstName",value:et.firstName,onChange:e=>en({...et,firstName:e.target.value}),className:"col-span-3"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(h._,{htmlFor:"lastName",className:"text-right",children:"Last Name"}),(0,t.jsx)(x.I,{id:"lastName",value:et.lastName,onChange:e=>en({...et,lastName:e.target.value}),className:"col-span-3"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(h._,{htmlFor:"email",className:"text-right",children:"Email"}),(0,t.jsx)(x.I,{id:"email",type:"email",value:et.email,onChange:e=>en({...et,email:e.target.value}),className:"col-span-3"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(h._,{htmlFor:"enabled",className:"text-right",children:"Enabled"}),(0,t.jsx)(p,{id:"enabled",checked:et.enabled,onCheckedChange:e=>en({...et,enabled:e})})]})]}),(0,t.jsxs)(m.cN,{children:[(0,t.jsx)(o.z,{variant:"outline",onClick:()=>ee({open:!1,user:null}),children:"Cancel"}),(0,t.jsxs)(o.z,{onClick:eh,disabled:K,children:[K?(0,t.jsx)(N.Z,{className:"h-4 w-4 animate-spin mr-2"}):null,"Save Changes"]})]})]})}),(0,t.jsx)(m.Vq,{open:es.open,onOpenChange:e=>ea({open:e,user:null}),children:(0,t.jsxs)(m.cZ,{children:[(0,t.jsxs)(m.fK,{children:[(0,t.jsx)(m.$N,{children:"Manage Roles"}),(0,t.jsxs)(m.Be,{children:["Add or remove roles for"," ",(null===(S=es.user)||void 0===S?void 0:S.displayName)||"".concat(null===(Z=es.user)||void 0===Z?void 0:Z.firstName," ").concat(null===(z=es.user)||void 0===z?void 0:z.lastName)]})]}),(0,t.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(h._,{htmlFor:"action",className:"text-right",children:"Action"}),(0,t.jsxs)(f.Ph,{value:el.action,onValueChange:e=>er({...el,action:e}),children:[(0,t.jsx)(f.i4,{className:"col-span-3",children:(0,t.jsx)(f.ki,{})}),(0,t.jsxs)(f.Bw,{children:[(0,t.jsx)(f.Ql,{value:"add",children:"Add Role"}),(0,t.jsx)(f.Ql,{value:"remove",children:"Remove Role"})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(h._,{htmlFor:"roleName",className:"text-right",children:"Role"}),(0,t.jsxs)(f.Ph,{value:el.roleName,onValueChange:e=>er({...el,roleName:e}),children:[(0,t.jsx)(f.i4,{className:"col-span-3",children:(0,t.jsx)(f.ki,{placeholder:"Select a role"})}),(0,t.jsxs)(f.Bw,{children:[(0,t.jsx)(f.Ql,{value:"ADMIN",children:"Admin"}),(0,t.jsx)(f.Ql,{value:"USER",children:"User"}),(0,t.jsx)(f.Ql,{value:"MODERATOR",children:"Moderator"}),(0,t.jsx)(f.Ql,{value:"EDITOR",children:"Editor"})]})]})]}),es.user&&(0,t.jsxs)("div",{className:"col-span-4",children:[(0,t.jsx)(h._,{children:"Current Roles:"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:es.user.roles.map((e,s)=>(0,t.jsx)(d.C,{variant:"secondary",children:e},s))})]})]}),(0,t.jsxs)(m.cN,{children:[(0,t.jsx)(o.z,{variant:"outline",onClick:()=>ea({open:!1,user:null}),children:"Cancel"}),(0,t.jsxs)(o.z,{onClick:ef,disabled:F||Q||!el.roleName,children:[F||Q?(0,t.jsx)(N.Z,{className:"h-4 w-4 animate-spin mr-2"}):null,"add"===el.action?"Add Role":"Remove Role"]})]})]})})]})}},26110:function(e,s,a){"use strict";a.d(s,{$N:function(){return x},Be:function(){return h},Vq:function(){return i},cN:function(){return m},cZ:function(){return o},fK:function(){return u}});var t=a(57437);a(2265);var n=a(49027),l=a(32489),r=a(94508);function i(e){let{...s}=e;return(0,t.jsx)(n.fC,{"data-slot":"dialog",...s})}function d(e){let{...s}=e;return(0,t.jsx)(n.h_,{"data-slot":"dialog-portal",...s})}function c(e){let{className:s,...a}=e;return(0,t.jsx)(n.aV,{"data-slot":"dialog-overlay",className:(0,r.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",s),...a})}function o(e){let{className:s,children:a,showCloseButton:i=!0,...o}=e;return(0,t.jsxs)(d,{"data-slot":"dialog-portal",children:[(0,t.jsx)(c,{}),(0,t.jsxs)(n.VY,{"data-slot":"dialog-content",className:(0,r.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",s),...o,children:[a,i&&(0,t.jsxs)(n.x8,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,t.jsx)(l.Z,{}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function u(e){let{className:s,...a}=e;return(0,t.jsx)("div",{"data-slot":"dialog-header",className:(0,r.cn)("flex flex-col gap-2 text-center sm:text-left",s),...a})}function m(e){let{className:s,...a}=e;return(0,t.jsx)("div",{"data-slot":"dialog-footer",className:(0,r.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",s),...a})}function x(e){let{className:s,...a}=e;return(0,t.jsx)(n.Dx,{"data-slot":"dialog-title",className:(0,r.cn)("text-lg leading-none font-semibold",s),...a})}function h(e){let{className:s,...a}=e;return(0,t.jsx)(n.dk,{"data-slot":"dialog-description",className:(0,r.cn)("text-muted-foreground text-sm",s),...a})}},26815:function(e,s,a){"use strict";a.d(s,{_:function(){return r}});var t=a(57437);a(2265);var n=a(6394),l=a(94508);function r(e){let{className:s,...a}=e;return(0,t.jsx)(n.f,{"data-slot":"label",className:(0,l.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",s),...a})}},592:function(e,s,a){"use strict";a.d(s,{Cx:function(){return i},I1:function(){return c},Mk:function(){return d},UL:function(){return o},g8:function(){return r},kD:function(){return m},ku:function(){return u}});var t=a(23557),n=a(79523);let l=a(40257).env.NEXT_PUBLIC_API_BASE_URL||"https://api.api-ngin.oudom.dev/api",r=(0,t.LC)({reducerPath:"usersApi",baseQuery:(0,n.ni)({baseUrl:l,prepareHeaders:e=>{let s=localStorage.getItem("token");return e.set("content-type","application/json"),s&&e.set("authorization","Bearer ".concat(s)),e}}),tagTypes:["User"],endpoints:e=>({fetchUsers:e.query({query:()=>"/admin/users",providesTags:["User"]}),fetchUsersPaginated:e.query({query:e=>{let{page:s,size:a=10,search:t}=e;return new URLSearchParams({page:s.toString(),size:a.toString(),...t&&{search:t}}),"/admin/users/paginated"},providesTags:["User"]}),deleteUser:e.mutation({query:e=>({url:"/admin/users/".concat(e),method:"DELETE"}),invalidatesTags:["User"]}),addRoleToUser:e.mutation({query:e=>{let{keycloakUserId:s,roleName:a}=e;return{url:"/admin/users/".concat(s,"/roles/").concat(a),method:"POST"}},invalidatesTags:["User"]}),removeRoleFromUser:e.mutation({query:e=>{let{keycloakUserId:s,roleName:a}=e;return{url:"/admin/users/".concat(s,"/roles/").concat(a),method:"DELETE"}},invalidatesTags:["User"]}),updateUser:e.mutation({query:e=>{let{keycloakUserId:s,userData:a}=e;return{url:"/admin/users",method:"PUT",body:{keycloakUserId:s,...a}}},invalidatesTags:["User"]})})}),{useFetchUsersQuery:i,useFetchUsersPaginatedQuery:d,useDeleteUserMutation:c,useAddRoleToUserMutation:o,useRemoveRoleFromUserMutation:u,useUpdateUserMutation:m}=r}},function(e){e.O(0,[516,203,557,847,377,614,971,117,744],function(){return e(e.s=58034)}),_N_E=e.O()}]);